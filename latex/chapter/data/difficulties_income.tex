\section{Difficulties of modelling income data}
\label{ch:difficulties}
The estimation of poverty indicators poses two main challenges.
First, indicators such as the head count ratio and the poverty gap are non-linear transforms of income.
This makes it hard to model them directly as a dependent variable in a regression, because it is necessary to model income first.
This leads to the second challenge.
Empirically, income is characterized by a right-skewed, unimodel and leptokurtic distribution:
most people earn an average or lower-than-average income, while only a few have very high incomes.
Using a linear model as in models \ref{eq:hb_rao} or \ref{eq:mod_hb} naively will lead to poor results.
There are two possible ways to deal with this characteristic shape of income data.
First, a GLM-regression with a skewed distribution (e.g., gamma, skew-normal, lognormal, etc.) can be used to capture the main features of income.
Second, data-driven transformation can be applied to make income more symmetric or even closer to a normal distribution as in in \cite{rojas_perilla_data_2020}.

Each approach presents its own challenges.
Choosing a skewed likelihood for a GLM model is all but straightforward.
First, common skewed distributions present the researcher with clear restrictions:
the skew-normal distribution has a maximum skewness of 1 and allows negative values, the lognormal implies that its logarithm must follow a normal distribution, the gamma likelihood assumes a fixed ratio between the expected value and the variance, exponential or Pareto distributions have the mode at their minimum.
This problem might in principle be alleviated by choosing a distribution with more parameters that allows a higher degree of flexibility such as a generalized beta distribution.
However, this additional flexibility comes at the cost of interpretability and ease of parametrization.
In cases where the use of a highly complex likelihood distribution seems necessary, the question arises whether it might be better to use a non-parametric method instead.
Moreover, skewed likelihoods can cause problems for the sampling algorithm. HMC can have trouble with the heavy tail to the right of the distribution mode, which can increase the sampling time considerably \citep{betancourt_conceptual_2017}.

On the other hand, the approach using data-driven transformations has to choose an appropriate transformation and consider the uncertainty generated by the estimation of transformation parameters.
It is not guaranteed that after the transformation the dependent variable will display more desirable properties such as symmetry or closeness to a normal distribution.
Moreover, the complexity of backtransformation functions vary depending on the chosen transformation.
For a log or log-shift transformation, the backtransformation can be done simply with the exponential function.
Nevertheless, more complex and piecewise transformation such as the Box-Cox have less straightforward backtransformation functions.
Finally, due to backtransformation it is usually not clear what the impact of the model parameters is in the original scale.
For example, a normal distribution in the transformed scale with parameters $\mu$ and $\sigma$ becomes a lognormal distribution when backtransforming with the exponential function.
In the backtransformed scale, the mean is a function of both $\mu$ and $\sigma$ given by $e^{\mu + \frac{\sigma^2}{2}}$.
However, if the likelihood in the transformed scale is a Student's $t$-distribution and a data-driven transformation is used, it is difficult to know the exact effect of the likelihood parameters $\mu, \sigma$ and $\nu$ on the mean in the backtransformed scale.

There is a last difficulty related to both the skewed likelihood and the data-driven transformations approach.
Choosing a likelihood or transformation does not only entail an assumption on the dependent variable, but also on the type of model.
A skew-normal distribution assumes an additive model, as the mean can be parametrized directly in the original scale. On the other hand, a gamma distribution with the commonly used log-link implies a multiplicative model in the original scale.
Similarly, a transformation like a log-shift with an additive likelihood in the transformed scale (e.g., normal distribution) causes the covariates to have a multiplicative effect in the backtransformed scale.
In practice, it is not possible to know whether the true data generating process is additive or multiplicative so it is necessary to check the models against both additive and multiplicative simulation scenarios.

To explore how income can be modelled in a Bayesian context, data from the Mexican state of Guerrero as well as simulated scenarios are used to develop and showcase the model developed in chapter \ref{ch:workflow}.
In the next section, the Mexican data set is introduced.

%(EVTL SPÃ„TERA common fix is to transform the data with the natural logarithm which is easy to backtransform to the original scale with the exponential function. While this tends to make the distribution more symmetric, there might be some skewness left. Another problem is that the kurtosis of the log-transformed income rarely matches the kurtosis of a normal distribution.
%Another approach is to do a log or log-shift transformation of the outcome variable and model it with a symmetric distribution such as a Normal, Student-t, Logistic or Cauchy.
%The log-shift transformation has the advantage of being mathematically simpler than power transformations and it is already widely used for income data in fields such as econometrics. While there might be some skewness left after taking the logarithm, this can still be minimized by choosing an appropriate shift term. Moreover, the shift term eliminates values that are close to zero which can be a problem in the logarithmic scale, since $\underset{x \rightarrow 0}\lim \log(x) = -\infty$. With almost no skewness left after the log-shift transformation, the main challenge is to model the excess kurtosis of the variable. Therefore, it is reasonable to use a distribution that allows for fat tails. This paper focuses on the second approach and explores how to best model the excess kurtosis of income in the log-scale.)

